diff --git a/libraries/session.inc.php b/libraries/session.inc.php
index fcd4507094f..4413c968f4b 100644
--- a/libraries/session.inc.php
+++ b/libraries/session.inc.php
@@ -13,6 +13,8 @@
     exit;
 }
 
+require PHPSECLIB_INC_DIR . '/Crypt/Random.php';
+
 // verify if PHP supports session, die if it does not
 
 if (!@function_exists('session_name')) {
@@ -111,7 +113,7 @@
  * (we use "space PMA_token space" to prevent overwriting)
  */
 if (! isset($_SESSION[' PMA_token '])) {
-    $_SESSION[' PMA_token '] = md5(uniqid(rand(), true));
+    $_SESSION[' PMA_token '] = bin2hex(phpseclib\Crypt\Random::string(16));
 }
 
 /**
@@ -130,5 +132,5 @@ function PMA_secureSession()
     ) {
         session_regenerate_id(true);
     }
-    $_SESSION[' PMA_token '] = md5(uniqid(rand(), true));
+    $_SESSION[' PMA_token '] = bin2hex(phpseclib\Crypt\Random::string(16));
 }
