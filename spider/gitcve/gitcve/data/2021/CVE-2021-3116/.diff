diff --git a/proxy/http/proxy/auth.py b/proxy/http/proxy/auth.py
index 263ec9bd0..d1ac9a861 100644
--- a/proxy/http/proxy/auth.py
+++ b/proxy/http/proxy/auth.py
@@ -35,8 +35,8 @@ def before_upstream_connection(
                 raise ProxyAuthenticationFailed()
             parts = request.headers[b'proxy-authorization'][1].split()
             if len(parts) != 2 \
-                    and parts[0].lower() != b'basic' \
-                    and parts[1] != self.flags.auth_code:
+                    or parts[0].lower() != b'basic' \
+                    or parts[1] != self.flags.auth_code:
                 raise ProxyAuthenticationFailed()
         return request
 
