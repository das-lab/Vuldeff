diff --git a/file/lang/en b/file/lang/en
index 12f49f94f1..92a2f3b197 100644
--- a/file/lang/en
+++ b/file/lang/en
@@ -168,6 +168,7 @@ view_ecmd=The command $1 needed to create an archive is not installed
 view_ecomp=Failed to create archive : $1
 view_earchive=You are not allowed to download archives
 view_earchmax=The selected directory is larger than the maximum allowed for archiving ($1 bytes)
+view_epathinfo=Path contains invalid characters
 
 paste_ecopy=You must cut or copy before pasting
 paste_egone=Copied file $1 no longer exists
diff --git a/file/show.cgi b/file/show.cgi
index 6ddb4c5440..e011f83f12 100755
--- a/file/show.cgi
+++ b/file/show.cgi
@@ -7,6 +7,8 @@ require './file-lib.pl';
 &ReadParse();
 use POSIX;
 $p = $ENV{'PATH_INFO'};
+($p =~ /^\s*\|/ || $p =~ /\|\s*$/ || $p =~ /\0/) &&
+	&error_exit($text{'view_epathinfo'});
 if ($in{'type'}) {
 	# Use the supplied content type
 	$type = $in{'type'};
@@ -116,7 +118,7 @@ if ($in{'format'}) {
 	close(FILE);
 	}
 else {
-	if (!open(FILE, $p)) {
+	if (!open(FILE, "<", $p)) {
 		# Unix permissions prevent access
 		&error_exit(&text('view_eopen', $p, $!));
 		}
