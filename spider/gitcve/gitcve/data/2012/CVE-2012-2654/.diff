diff --git a/nova/api/ec2/cloud.py b/nova/api/ec2/cloud.py
index 52def33c1bd0..ac445c262615 100644
--- a/nova/api/ec2/cloud.py
+++ b/nova/api/ec2/cloud.py
@@ -610,7 +610,7 @@ def _rule_dict_last_step(self, context, to_port=None, from_port=None,
                       to_port=to_port, msg="For ICMP, the"
                                            " type:code must be valid")
 
-            values['protocol'] = ip_protocol
+            values['protocol'] = ip_protocol.lower()
             values['from_port'] = from_port
             values['to_port'] = to_port
         else:
diff --git a/nova/api/openstack/compute/contrib/security_groups.py b/nova/api/openstack/compute/contrib/security_groups.py
index 281cc8c71978..a9368c529dad 100644
--- a/nova/api/openstack/compute/contrib/security_groups.py
+++ b/nova/api/openstack/compute/contrib/security_groups.py
@@ -497,7 +497,7 @@ def _rule_args_to_dict(self, context, to_port=None, from_port=None,
                       to_port=to_port, msg="For ICMP, the"
                                            " type:code must be valid")
 
-            values['protocol'] = ip_protocol
+            values['protocol'] = ip_protocol.lower()
             values['from_port'] = from_port
             values['to_port'] = to_port
         else:
diff --git a/nova/virt/firewall.py b/nova/virt/firewall.py
index 3f533342752d..a41ece69fa1d 100644
--- a/nova/virt/firewall.py
+++ b/nova/virt/firewall.py
@@ -300,8 +300,8 @@ def instance_rules(self, instance, network_info):
                 else:
                     fw_rules = ipv6_rules
 
-                protocol = rule.protocol
-                if version == 6 and rule.protocol == 'icmp':
+                protocol = rule.protocol.lower()
+                if version == 6 and protocol == 'icmp':
                     protocol = 'icmpv6'
 
                 args = ['-j ACCEPT']
