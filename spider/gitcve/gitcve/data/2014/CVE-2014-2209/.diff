diff --git a/hphp/util/capability.cpp b/hphp/util/capability.cpp
index 56133790c46a..e4c9df2070d9 100644
--- a/hphp/util/capability.cpp
+++ b/hphp/util/capability.cpp
@@ -24,6 +24,7 @@
 #include <sys/prctl.h>
 #include <sys/types.h>
 #include <pwd.h>
+#include <grp.h>
 
 namespace HPHP {
 ///////////////////////////////////////////////////////////////////////////////
@@ -102,6 +103,12 @@ bool Capability::ChangeUnixUser(uid_t uid) {
       return false;
     }
 
+    if (initgroups(pw->pw_name, pw->pw_gid) < 0) {
+      Logger::Error("unable to drop supplementary group privs: %s",
+                    folly::errnoStr(errno).c_str());
+      return false;
+    }
+
     if (pw->pw_gid == 0 || setgid(pw->pw_gid) < 0) {
       Logger::Error("unable to drop gid privs: %s",
                     folly::errnoStr(errno).c_str());
diff --git a/hphp/util/light-process.cpp b/hphp/util/light-process.cpp
index 02d2c84260fa..3c67c32e66bf 100644
--- a/hphp/util/light-process.cpp
+++ b/hphp/util/light-process.cpp
@@ -25,6 +25,7 @@
 #include <sys/socket.h>
 
 #include <afdt.h>
+#include <grp.h>
 #include <stdlib.h>
 #include <unistd.h>
 #include <poll.h>
@@ -299,6 +300,7 @@ static void do_change_user(FILE *fin, FILE *fout) {
     struct passwd *pw = getpwnam(uname.c_str());
     if (pw) {
       if (pw->pw_gid) {
+        initgroups(pw->pw_name, pw->pw_gid);
         setgid(pw->pw_gid);
       }
       if (pw->pw_uid) {
