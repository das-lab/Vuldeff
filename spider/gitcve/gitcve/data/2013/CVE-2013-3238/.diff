diff --git a/libraries/Tracker.class.php b/libraries/Tracker.class.php
index 2f506238321..3d27f896a84 100644
--- a/libraries/Tracker.class.php
+++ b/libraries/Tracker.class.php
@@ -877,6 +877,9 @@ static public function handleQuery($query)
         if (empty($dbname)) {
             return;
         }
+        // Remove null bytes (preg_replace() is vulnerable in some
+        // PHP versions)
+        $dbname = str_replace("\0", "", $dbname);
 
         // If we found a valid statement
         if (isset($result['identifier'])) {
