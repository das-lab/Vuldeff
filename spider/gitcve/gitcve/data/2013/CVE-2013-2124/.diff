diff --git a/src/inspect-fs.c b/src/inspect-fs.c
index a8dc05cbfd..5ca17254ca 100644
--- a/src/inspect-fs.c
+++ b/src/inspect-fs.c
@@ -544,7 +544,7 @@ guestfs___check_package_management (guestfs_h *g, struct inspect_fs *fs)
 char *
 guestfs___first_line_of_file (guestfs_h *g, const char *filename)
 {
-  CLEANUP_FREE char **lines = NULL; /* sic: not CLEANUP_FREE_STRING_LIST */
+  char **lines = NULL; /* sic: not CLEANUP_FREE_STRING_LIST */
   int64_t size;
   char *ret;
 
@@ -573,6 +573,8 @@ guestfs___first_line_of_file (guestfs_h *g, const char *filename)
 
   ret = lines[0];               /* caller frees */
 
+  free (lines);
+
   return ret;
 }
 
