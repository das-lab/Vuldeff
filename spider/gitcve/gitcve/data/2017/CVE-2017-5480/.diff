diff --git a/inc/files/files.ctrl.php b/inc/files/files.ctrl.php
index 66a473a5b8..e7ecda94e8 100644
--- a/inc/files/files.ctrl.php
+++ b/inc/files/files.ctrl.php
@@ -343,8 +343,15 @@
  * @global Filelist
  */
 $selected_Filelist = new Filelist( $fm_FileRoot, $ads_list_path );
+
+// Prevent directory traversal using '..'
+$re = '/\/?\.\.\/+/';
 foreach( $fm_selected as $l_source_path )
 {
+	if( preg_match( $re, $l_source_path ) )
+	{
+		debug_die( 'Invalid fm_selected parameter value' );
+	}
 	$selected_Filelist->add_by_subpath( urldecode($l_source_path), true );
 }
 
